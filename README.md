A bit of a messy way to do it but it works well.

If you want to use this for a large large setting you should probably look into websockets.

